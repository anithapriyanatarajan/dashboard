import{L as O,u as E,V as X}from"./index-ZoblWWNj.js";import{j as e}from"./jsx-runtime-B0wN4eWF.js";import{u as Z}from"./index-CbuwW4_d.js";import{u as v}from"./usePrefix-DVhi0s40.js";import{_ as T,u as ee,d as re}from"./index-Cn2DnnuS.js";import{c as R}from"./index-7UTgOZSF.js";import{_ as a}from"./index-CvulwabO.js";import{r as D,R as l}from"./index-BLsgEXh-.js";import{T as V}from"./Text-9nRGETFr.js";import{m as se,E as te}from"./keys-fZP-1wUt.js";import{h as ae}from"./bucket-3-igrvqujs.js";import{V as F}from"./ViewYAML-BQtIWtmr.js";import{T as K}from"./Table-C546lFM3.js";import"./constants-CJ-WDauL.js";import"./Link-DsPvONv9.js";import"./index-CTl86HqP.js";import"./index-yR6ZHKQV.js";import"./index-DS1rTf2F.js";import"./Icon-Dlg6_ItC.js";import"./index-CfoIBI3E.js";import"./Button-DXQXyzWq.js";import"./index-mhCn_TNf.js";import"./Tooltip-wylFaEsh.js";import"./index-DN2bqo_D.js";import"./events-OVwOsPzJ.js";import"./index-DhdmMkKS.js";import"./debounce-DBudwqRe.js";import"./bucket-0-B3IHR_5I.js";import"./requiredIfGivenPropIsTruthy-CU7JwK8h.js";import"./mergeRefs-CTUecegF.js";import"./index-CLdR1d0e.js";import"./bucket-12-DVDhO4p7.js";import"./wrapFocus-Cvvm2ck9.js";import"./noopFn-g4z370MD.js";import"./Search-C-UQoaUd.js";import"./FormContext-D3yeToZb.js";import"./bucket-14-DcJR6G3p.js";import"./bucket-15-DETD0dec.js";const B=D.createContext({disabled:!1}),oe=i=>{let{disabled:n,children:s}=i;return l.createElement(B.Provider,{value:{disabled:n}},s)};function L(i){let{align:n="end",children:s,className:c,disabled:f=!1,isFlush:d=!1,ordered:x=!1,size:m,...N}=i;const g=v(),r=R(`${g}--accordion`,c,{[`${g}--accordion--${n}`]:n,[`${g}--accordion--${m}`]:m,[`${g}--layout--size-${m}`]:m,[`${g}--accordion--flush`]:d&&n!=="start"}),u=x?"ol":"ul";return l.createElement(oe,{disabled:f},l.createElement(u,T({className:r},N),s))}L.propTypes={align:a.oneOf(["start","end"]),children:a.node,className:a.string,disabled:a.bool,isFlush:a.bool,ordered:a.bool,size:a.oneOf(["sm","md","lg"])};const ne=i=>l.createElement("button",T({type:"button"},i));function z(i){let{children:n,className:s="",open:c=!1,onHeadingClick:f,renderExpando:d=ne,renderToggle:x,title:m="title",disabled:N,handleAnimationEnd:g,...r}=i;const[u,h]=D.useState(c),[y,M]=D.useState(c),_=D.useContext(B),t=typeof N=="boolean"?N:_.disabled,j=ee("accordion-item"),o=v(),b=R({[`${o}--accordion__item`]:!0,[`${o}--accordion__item--active`]:u&&!t,[`${o}--accordion__item--disabled`]:t,[s]:!!s}),q=x||d,U=l.useCallback(k=>{k&&u&&(k.style.maxBlockSize="")},[u]);c!==y&&(h(c),M(c));function Y(k){const A=!u;h(A),f&&f({isOpen:A,event:k})}function J(k){u&&se(k,te)&&h(!1)}function Q(k){g&&g(k)}return l.createElement("li",T({className:b},r),l.createElement(q,{disabled:t,"aria-controls":j,"aria-expanded":u,className:`${o}--accordion__heading`,onClick:Y,onKeyDown:J,type:"button"},l.createElement(ae,{className:`${o}--accordion__arrow`}),l.createElement(V,{as:"div",className:`${o}--accordion__title`},m)),l.createElement("div",{ref:U,className:`${o}--accordion__wrapper`,onTransitionEnd:Q},l.createElement("div",{id:j,className:`${o}--accordion__content`},n)))}z.propTypes={children:a.node,className:a.string,disabled:a.bool,onClick:a.func,onHeadingClick:a.func,open:a.bool,renderExpando:re(a.func),renderToggle:a.func,title:a.node};function P(i){let{className:n,children:s,...c}=i;const f=v(),d=R(`${f}--list__item`,n);return l.createElement(V,T({as:"li",className:d},c),s)}P.propTypes={children:a.node,className:a.string};function W(i){let{className:n,nested:s=!1,isExpressive:c=!1,...f}=i;const d=v(),x=R(`${d}--list--unordered`,n,{[`${d}--list--nested`]:s,[`${d}--list--expressive`]:c});return l.createElement("ul",T({className:x},f))}W.propTypes={children:a.node,className:a.string,isExpressive:a.bool,nested:a.bool};const G=({namespace:i,trigger:n})=>{const s=Z(),c=v(),f=[{key:"name",header:s.formatMessage({id:"dashboard.tableHeader.name",defaultMessage:"Name"})},{key:"value",header:s.formatMessage({id:"dashboard.tableHeader.value",defaultMessage:"Value"})}],{bindings:d,interceptors:x,template:m}=n.spec||n,N=m.ref||m.name,g=n.name;return e.jsxs("div",{children:[g&&e.jsxs("h3",{children:["Trigger: ",g]}),e.jsxs("div",{className:"tkn--trigger-details",children:[d&&d.length!==0&&e.jsxs("div",{className:"tkn--trigger-resourcelinks",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.triggerBindings",defaultMessage:"TriggerBindings:"})}),e.jsx(W,{children:d.map(r=>e.jsx(P,{children:r.ref?e.jsx(O,{className:"tkn--trigger-resourcelink",to:r.kind==="ClusterTriggerBinding"?E.clusterTriggerBindings.byName({name:r.ref}):E.triggerBindings.byName({name:r.ref,namespace:i}),children:e.jsx("span",{title:r.ref,children:r.ref})}):e.jsx(F,{dark:!0,resource:r})},r.ref||r.name))})]}),e.jsxs("div",{className:"tkn--trigger-resourcelinks",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.triggerTemplate",defaultMessage:"TriggerTemplate:"})}),m.spec?e.jsx(F,{dark:!0,resource:m}):e.jsx(O,{className:"tkn--trigger-resourcelink",to:E.triggerTemplates.byName({name:N,namespace:i}),children:e.jsx("span",{title:N,children:N})})]})]}),x&&x.length!==0&&e.jsxs("div",{className:"tkn--trigger-interceptors",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.interceptors",defaultMessage:"Interceptors:"})}),e.jsx(L,{className:"tkn--trigger-interceptors-accordion",title:"Interceptors",children:x.map((r,u)=>{let h,y;const M=s.formatMessage({id:"dashboard.triggerDetails.interceptorNamespace",defaultMessage:"Namespace:"}),_=s.formatMessage({id:"dashboard.triggerDetails.interceptorName",defaultMessage:"Name:"});if(r.webhook){if(!r.webhook.objectRef)return null;h="Webhook";let t=[];r.webhook.header&&(t=r.webhook.header.map(o=>{const b={id:o.name,name:o.name,value:o.value};return Array.isArray(o.value)&&(b.value=o.value.join(", ")),b}));const j=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorService",defaultMessage:"Service:"});y=e.jsxs(e.Fragment,{children:[e.jsx("p",{children:j}),e.jsxs("div",{className:"tkn--trigger-interceptor-service-details",children:[e.jsxs("p",{children:[e.jsx("span",{children:_}),r.webhook.objectRef.name]}),r.webhook.objectRef.namespace&&e.jsxs("p",{children:[e.jsx("span",{children:M}),r.webhook.objectRef.namespace]})]}),t.length!==0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.interceptorHeader",defaultMessage:"Header:"})}),e.jsx(K,{headers:f,rows:t,size:"sm",emptyTextAllNamespaces:s.formatMessage({id:"dashboard.trigger.noHeaders",defaultMessage:"No headers found for this interceptor."}),emptyTextSelectedNamespace:s.formatMessage({id:"dashboard.trigger.noHeaders",defaultMessage:"No headers found for this interceptor."}),isSortable:!1})]})]})}else if(r.github||r.gitlab){let t;r.github?(h="GitHub",t=r.github):(h="GitLab",t=r.gitlab);const j=t.eventTypes?.join(", "),o=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorSecret",defaultMessage:"Secret:"}),b=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorSecretKey",defaultMessage:"Key:"});y=e.jsxs(e.Fragment,{children:[t.secretRef&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:o}),e.jsxs("div",{className:"tkn--trigger-interceptor-secret-details",children:[e.jsxs("p",{children:[_," ",t.secretRef.secretName]}),e.jsxs("p",{children:[b," ",t.secretRef.secretKey]}),t.secretRef.namespace&&e.jsxs("p",{children:[M," ",t.secretRef.namespace]})]})]}),e.jsxs("p",{children:["Event Types: ",j]})]})}else if(r.cel){h="CEL";const t=[{key:"key",header:s.formatMessage({id:"dashboard.tableHeader.key",defaultMessage:"Key"})},{key:"expression",header:s.formatMessage({id:"dashboard.tableHeader.expression",defaultMessage:"Expression"})}],o=(r.cel.overlays||[]).map(b=>({id:b.key,key:b.key,expression:b.expression}));y=e.jsxs(e.Fragment,{children:[r.cel.filter&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.celInterceptorFilter",defaultMessage:"Filter:"})}),e.jsx("code",{className:`${c}--snippet--multi tkn--trigger-interceptor-cel-filter`,children:r.cel.filter})]}),e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.celInterceptorOverlays",defaultMessage:"Overlays:"})}),e.jsx(K,{headers:t,rows:o,size:"sm",isSortable:!1,emptyTextAllNamespaces:s.formatMessage({id:"dashboard.trigger.noOverlays",defaultMessage:"No overlays found for this interceptor."}),emptyTextSelectedNamespace:s.formatMessage({id:"dashboard.trigger.noOverlays",defaultMessage:"No overlays found for this interceptor."})})]})}else if(r.ref){h="ClusterInterceptor";const t=r.ref.name;y=e.jsx(O,{to:E.clusterInterceptors.byName({name:t}),title:t,children:t})}else return null;const H=s.formatMessage({id:"dashboard.triggerDetails.interceptorTitle",defaultMessage:"{interceptorNumber}. ({interceptorType}) {interceptorName}"},{interceptorNumber:u+1,interceptorType:h,interceptorName:""});return e.jsx(z,{title:H,children:y},H)})})]})]})};G.__docgenInfo={description:"",methods:[],displayName:"Trigger"};const p={namespace:"default",trigger:{name:"my-trigger",bindings:[{ref:"triggerbinding0"},{ref:"triggerbinding1"},{ref:"triggerbinding2"},{name:"triggerbinding3",value:"$(body.head_commit_id)"}],template:{ref:"triggertemplate"},interceptors:[{webhook:{header:[{name:"header0",value:"value0"},{name:"header1",value:["value1-0","value1-1","value1-2"]}],objectRef:{apiVersion:"v1",kind:"Service",name:"interceptor-service0",namespace:"foo"}}},{github:{secretRef:{secretName:"github-secret",secretKey:"secret"},eventTypes:["push","pull_request"]}},{gitlab:{secretRef:{secretName:"gitlab-secret",secretKey:"secret",namespace:"foo"},eventTypes:["Push Hook"]}},{cel:{filter:"body.matches('foo', 'bar')"}}]}},We={component:G,decorators:[X()],title:"Trigger"},I={args:p},w={args:{...p,trigger:{...p.trigger,name:void 0}}},$={args:{...p,trigger:{...p.trigger,bindings:void 0}}},S={args:{...p,trigger:{...p.trigger,interceptors:void 0}}},C={args:{...p,trigger:{...p.trigger,interceptors:[{...p.trigger.interceptors[0],webhook:{...p.trigger.interceptors[0].webhook,header:void 0}}]}}};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  args: props
}`,...I.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      name: undefined
    }
  }
}`,...w.parameters?.docs?.source}}};$.parameters={...$.parameters,docs:{...$.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      bindings: undefined
    }
  }
}`,...$.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      interceptors: undefined
    }
  }
}`,...S.parameters?.docs?.source}}};C.parameters={...C.parameters,docs:{...C.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      interceptors: [{
        ...props.trigger.interceptors[0],
        webhook: {
          ...props.trigger.interceptors[0].webhook,
          header: undefined
        }
      }]
    }
  }
}`,...C.parameters?.docs?.source}}};const Ge=["Default","NoName","NoBindings","NoInterceptors","NoHeadersInWebhookInterceptor"];export{I as Default,$ as NoBindings,C as NoHeadersInWebhookInterceptor,S as NoInterceptors,w as NoName,Ge as __namedExportsOrder,We as default};
