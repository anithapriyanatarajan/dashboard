import{a as je,b as Le,u as Pe,_ as y,c as Re,s as ze,f as Ke,h as We,d as M}from"./index-Cn2DnnuS.js";import{R as o,r as s}from"./index-BLsgEXh-.js";import{u as fe,L as E,a as Be,b as Ue}from"./index-CjqBRizy.js";import{c as T}from"./index-7UTgOZSF.js";import{_ as n}from"./index-CvulwabO.js";import{m as qe}from"./mergeRefs-CTUecegF.js";import{u as He}from"./usePrefix-DVhi0s40.js";import{F as Ve}from"./FormContext-D3yeToZb.js";import{a as Ge,W as Je}from"./bucket-18-D1v83Eua.js";import{g as Qe}from"./bucket-3-igrvqujs.js";const{ItemMouseMove:Xe,MenuMouseLeave:Ye}=fe.stateChangeTypes,ue=r=>typeof r=="string"?r:typeof r=="number"?`${r}`:r!==null&&typeof r=="object"&&"label"in r&&typeof r.label=="string"?r.label:"";function pe(r,A){const{changes:i,type:S}=A;switch(S){case Xe:case Ye:return i.highlightedIndex===r.highlightedIndex?r:i;default:return i}}const me=o.forwardRef((r,A)=>{let{autoAlign:i=!1,className:S,decorator:h,disabled:x=!1,direction:j="bottom",items:L,label:P,["aria-label"]:R,ariaLabel:z,itemToString:u=ue,itemToElement:K=null,renderSelectedItem:W,type:be="default",size:k,onChange:v,id:ge,titleText:B="",hideLabel:we,helperText:C="",translateWithId:ye,light:U,invalid:a,invalidText:he,warn:_,warnText:xe,initialSelectedItem:q,selectedItem:H,downshiftProps:V,readOnly:$,slug:I,..._e}=r;const b=je("enable-v12-dynamic-floating-styles"),{refs:m,floatingStyles:G,middlewareData:$e}=Le(b||i?{placement:j,strategy:"fixed",middleware:[ze({apply(e){let{rects:l,elements:w}=e;Object.assign(w.floating.style,{width:`${l.reference.width}px`})}}),i&&Ke(),i&&We()],whileElementsMounted:Re}:{});s.useEffect(()=>{if(b||i){const e={...G,visibility:$e.hide?.referenceHidden?"hidden":"visible"};Object.keys(e).forEach(l=>{m.floating.current&&(m.floating.current.style[l]=e[l])})}},[G,i,m.floating]);const t=He(),{isFluid:J}=s.useContext(Ve),Q=s.useCallback(e=>{let{selectedItem:l}=e;v&&v({selectedItem:l??null})},[v]),X=s.useCallback((e,l)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),Y=s.useCallback(e=>{const{highlightedIndex:l}=e;if(l!==void 0&&l>-1&&typeof window!==void 0){const c=document.querySelectorAll(`li.${t}--list-box__menu-item[role="option"]`)[l];c&&c.scrollIntoView({behavior:"smooth",block:"nearest"})}},[t]),D=s.useMemo(()=>L,[L]),Z=s.useMemo(()=>({items:D,itemToString:u,initialSelectedItem:q,onSelectedItemChange:Q,stateReducer:pe,isItemDisabled:X,onHighlightedIndexChange:Y,...V}),[D,u,q,Q,pe,X,Y,V]),Ie=Pe();H!==void 0&&(Z.selectedItem=H);const{isOpen:p,getToggleButtonProps:ee,getLabelProps:Ee,getMenuProps:te,getItemProps:Te,selectedItem:d,highlightedIndex:Ae}=fe(Z),f=be==="inline",ne=!a&&_,[Se,F]=s.useState(!1),ke=T(`${t}--dropdown`,{[`${t}--dropdown--invalid`]:a,[`${t}--dropdown--warning`]:ne,[`${t}--dropdown--open`]:p,[`${t}--dropdown--focus`]:Se,[`${t}--dropdown--inline`]:f,[`${t}--dropdown--disabled`]:x,[`${t}--dropdown--light`]:U,[`${t}--dropdown--readonly`]:$,[`${t}--dropdown--${k}`]:k,[`${t}--list-box--up`]:j==="top",[`${t}--autoalign`]:i}),ve=T(`${t}--label`,{[`${t}--label--disabled`]:x,[`${t}--visually-hidden`]:we}),Ce=T(`${t}--form__helper-text`,{[`${t}--form__helper-text--disabled`]:x}),De=T(`${t}--dropdown__wrapper`,`${t}--list-box__wrapper`,S,{[`${t}--dropdown__wrapper--inline`]:f,[`${t}--list-box__wrapper--inline`]:f,[`${t}--dropdown__wrapper--inline--invalid`]:f&&a,[`${t}--list-box__wrapper--inline--invalid`]:f&&a,[`${t}--list-box__wrapper--fluid--invalid`]:J&&a,[`${t}--list-box__wrapper--slug`]:I,[`${t}--list-box__wrapper--decorator`]:h}),oe=C?`dropdown-helper-text-${Ie}`:void 0,N=K,g=s.useMemo(()=>ee({"aria-label":R||z}),[ee,R,z,p]),le=C&&!J?o.createElement("div",{id:oe,className:Ce},C):null,se=e=>{F(e.type==="focus"&&!d)},re=qe(g.ref,A),[O,Fe]=s.useState(),[ie,ae]=s.useState(!1),de=s.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&ae(!0),(ie&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(O&&clearTimeout(O),Fe(setTimeout(()=>{ae(!1)},3e3))),["ArrowDown"].includes(e.key)&&F(!1),["Enter"].includes(e.key)&&!d&&!p&&F(!0),g.onKeyDown&&(e.key!=="ArrowUp"||p&&e.key==="ArrowUp")&&g.onKeyDown(e)},[ie,O,g]),Ne=s.useMemo(()=>$?{onClick:e=>{e.preventDefault(),re?.current?.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:de},[$,de]),Oe=s.useMemo(()=>te({ref:b||i?m.setFloating:null}),[i,te,m.setFloating,b]),ce=s.useMemo(()=>{let e=I??h;return e&&e.type?.displayName==="AILabel"?o.cloneElement(e,{size:"mini"}):o.isValidElement(e)?e:null},[I,h]);return o.createElement("div",y({className:De},_e),B&&o.createElement("label",y({className:ve},Ee()),B),o.createElement(E,{onFocus:se,onBlur:se,size:k,className:ke,invalid:a,invalidText:he,warn:_,warnText:xe,light:U,isOpen:p,ref:b||i?m.setReference:null,id:ge},a&&o.createElement(Ge,{className:`${t}--list-box__invalid-icon`}),ne&&o.createElement(Je,{className:`${t}--list-box__invalid-icon ${t}--list-box__invalid-icon--warning`}),o.createElement("button",y({type:"button",className:`${t}--list-box__field`,disabled:x,"aria-disabled":$?!0:void 0,"aria-describedby":!f&&!a&&!_&&le?oe:void 0,title:d&&u!==void 0?u(d):ue(P)},g,Ne,{ref:re}),o.createElement("span",{className:`${t}--list-box__label`},d?W?W(d):u(d):P),o.createElement(E.MenuIcon,{isOpen:p,translateWithId:ye})),I?ce:h?o.createElement("div",{className:`${t}--list-box__inner-wrapper--decorator`},ce):"",o.createElement(E.Menu,Oe,p&&D.map((e,l)=>{const w=e!==null&&typeof e=="object",c=Te({item:e,index:l});e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"id")&&(c.id=e.id);const Me=w&&"text"in e&&K?e.text:u(e);return o.createElement(E.MenuItem,y({key:c.id,isActive:d===e,isHighlighted:Ae===l,title:Me,disabled:c["aria-disabled"]},c),typeof e=="object"&&N!==void 0&&N!==null?o.createElement(N,y({key:c.id},e)):u(e),d===e&&o.createElement(Qe,{className:`${t}--list-box__menu-item__selected-icon`}))}))),!f&&!a&&!_&&le)});me.displayName="Dropdown";me.propTypes={"aria-label":n.string,ariaLabel:M(n.string),autoAlign:n.bool,className:n.string,decorator:n.node,direction:n.oneOf(["top","bottom"]),disabled:n.bool,downshiftProps:n.object,helperText:n.node,hideLabel:n.bool,id:n.string.isRequired,initialSelectedItem:n.oneOfType([n.object,n.string,n.number]),invalid:n.bool,invalidText:n.node,itemToElement:n.func,itemToString:n.func,items:n.array.isRequired,label:n.node.isRequired,light:M(n.bool),onChange:n.func,readOnly:n.bool,renderSelectedItem:n.func,selectedItem:n.oneOfType([n.object,n.string,n.number]),size:Ue,slug:M(n.node),titleText:n.node.isRequired,translateWithId:n.func,type:Be,warn:n.bool,warnText:n.node};export{me as D};
