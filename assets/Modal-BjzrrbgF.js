import{j as je}from"./jsx-runtime-B0wN4eWF.js";import{u as We}from"./index-CbuwW4_d.js";import{u as k}from"./usePrefix-DVhi0s40.js";import{_ as B,d as be,u as Ke,a as Ve}from"./index-Cn2DnnuS.js";import{_ as e}from"./index-CvulwabO.js";import{R as t,r as p}from"./index-BLsgEXh-.js";import{c as y}from"./index-7UTgOZSF.js";import{B as q}from"./Button-DXQXyzWq.js";import{E as Ge}from"./bucket-6-KyTwAsSL.js";import{C as Ue,a as Xe}from"./bucket-3-igrvqujs.js";import{r as Je}from"./requiredIfGivenPropIsTruthy-CU7JwK8h.js";import{a as Qe,w as Ye,e as Ze}from"./wrapFocus-Cvvm2ck9.js";import{u as et}from"./index-DN2bqo_D.js";import{I as tt}from"./index-mhCn_TNf.js";import{n as j}from"./noopFn-g4z370MD.js";import{c as nt}from"./events-OVwOsPzJ.js";import{T as me}from"./Text-9nRGETFr.js";import{m as W,E as at,b as ot,T as st}from"./keys-fZP-1wUt.js";import{d as rt}from"./debounce-DBudwqRe.js";const K=t.forwardRef(function(o,s){let{children:d,className:c,stacked:b,...f}=o;const r=k(),i=y(c,`${r}--btn-set`,{[`${r}--btn-set--stacked`]:b});return t.createElement("div",B({},f,{className:i,ref:s}),d)});K.displayName="ButtonSet";K.propTypes={children:e.node,className:e.string,stacked:e.bool};const fe=t.createContext(1),ye=["one","two","three"],lt=0,it=ye.length-1,V=t.forwardRef(function(o,s){let{as:d="div",className:c,children:b,level:f,...r}=o;const i=t.useContext(fe),$=f??i,u=k(),x=y(`${u}--layer-${ye[$]}`,c),L=Math.max(lt,Math.min($+1,it)),m=d;return t.createElement(fe.Provider,{value:L},t.createElement(m,B({ref:s},r,{className:x}),b))});V.displayName="Layer";V.propTypes={as:e.oneOfType([e.func,e.string,e.elementType]),children:e.node,className:e.string,level:e.oneOf([0,1,2])};const ge=V;function he(l){let{active:o=!0,className:s,withOverlay:d=!0,small:c=!1,description:b="loading",...f}=l;const r=k(),i=y(s,{[`${r}--loading`]:!0,[`${r}--loading--small`]:c,[`${r}--loading--stop`]:!o}),$=y({[`${r}--loading-overlay`]:!0,[`${r}--loading-overlay--stop`]:!o}),u=t.createElement("div",B({},f,{"aria-atomic":"true","aria-live":o?"assertive":"off",className:i}),t.createElement("svg",{className:`${r}--loading__svg`,viewBox:"0 0 100 100"},t.createElement("title",null,b),c?t.createElement("circle",{className:`${r}--loading__background`,cx:"50%",cy:"50%",r:"42"}):null,t.createElement("circle",{className:`${r}--loading__stroke`,cx:"50%",cy:"50%",r:c?"42":"44"})));return d?t.createElement("div",{className:$},u):u}he.propTypes={active:e.bool,className:e.string,description:e.string,id:be(e.string),small:e.bool,withOverlay:e.bool};const Ee=l=>{let{className:o,status:s="active",iconDescription:d,description:c,onSuccess:b,successDelay:f=1500,...r}=l;const i=k(),$=y(`${i}--inline-loading`,o),u=()=>{let h=d||s;if(s==="error")return t.createElement(Ge,{className:`${i}--inline-loading--error`},t.createElement("title",null,h));if(s==="finished")return setTimeout(()=>{b&&b()},f),t.createElement(Ue,{className:`${i}--inline-loading__checkmark-container`},t.createElement("title",null,h));if(s==="inactive"||s==="active")return d||(h=s==="active"?"loading":"not loading"),t.createElement(he,{small:!0,description:h,withOverlay:!1,active:s==="active"})},x=t.createElement("div",{className:`${i}--inline-loading__text`},c),L=u(),m=L&&t.createElement("div",{className:`${i}--inline-loading__animation`},L);return t.createElement("div",B({className:$},r,{"aria-live":"assertive"}),m,c&&x)};Ee.propTypes={className:e.string,description:e.node,iconDescription:e.string,onSuccess:e.func,status:e.oneOf(["inactive","active","finished","error"]),successDelay:e.number};function pe(l,o,s){l.classList.contains(o)===!s&&l.classList[s?"add":"remove"](o)}const ct=["xs","sm","md","lg"],ve=t.forwardRef(function(o,s){let{"aria-label":d,children:c,className:b,decorator:f,modalHeading:r="",modalLabel:i="",modalAriaLabel:$,passiveModal:u=!1,secondaryButtonText:x,primaryButtonText:L,open:m,onRequestClose:h=j,onRequestSubmit:G=j,onSecondarySubmit:A,primaryButtonDisabled:$e=!1,danger:T,alert:U,secondaryButtons:_,selectorPrimaryFocus:X="[data-modal-primary-focus]",selectorsFloatingMenus:J,shouldSubmitOnEnter:Ne,size:Q,hasScrollingContent:Y=!1,closeButtonLabel:Z="Close",preventCloseOnClickOutside:Ce=!1,isFullWidth:Be,launcherButtonRef:D,loadingStatus:w="inactive",loadingDescription:xe,loadingIconDescription:Le,onLoadingSuccess:Se=j,slug:I,...ee}=o;const n=k(),R=p.useRef(null),te=p.useRef(null),C=p.useRef(null),N=p.useRef(null),ne=p.useRef(null),ae=p.useRef(null),[oe,se]=p.useState(!1),P=`modal-${Ke()}`,re=`${n}--modal-header__label--${P}`,le=`${n}--modal-header__heading--${P}`,ie=`${n}--modal-body--${P}`,H=`${n}--modal-close`,_e=y({[`${n}--btn--loading`]:w!=="inactive"}),z=w!=="inactive",F=Ve("enable-experimental-focus-wrap-without-sentinels");function ke(a){return!A&&a===te.current||a.classList.contains(H)}function Te(a){a.stopPropagation(),m&&(W(a,at)&&h(a),W(a,ot)&&Ne&&!ke(a.target)&&G(a),F&&W(a,st)&&N.current&&Ye({containerNode:N.current,currentActiveNode:a.target,event:a}))}function we(a){const g=a.target;a.stopPropagation(),!Ce&&!Ze(g,J)&&N.current&&!N.current.contains(g)&&h(a)}function Ie(a){let{target:g,relatedTarget:E}=a;if(m&&E&&g){const{current:v}=N,{current:M}=ne,{current:qe}=ae;Qe({bodyNode:v,startTrapNode:M,endTrapNode:qe,currentActiveNode:E,oldActiveNode:g,selectorsFloatingMenus:J})}}const Re=A||h,Fe=y(`${n}--modal`,{[`${n}--modal-tall`]:!u,"is-visible":m,[`${n}--modal--danger`]:T,[`${n}--modal--slug`]:I,[`${n}--modal--decorator`]:f},b),Oe=y(`${n}--modal-container`,{[`${n}--modal-container--${Q}`]:Q,[`${n}--modal-container--full-width`]:Be}),Me=y(`${n}--modal-content`,{[`${n}--modal-scroll-content`]:Y||oe}),Ae=y(`${n}--modal-footer`,{[`${n}--modal-footer--three-button`]:Array.isArray(_)&&_.length===2}),ce=a=>typeof a=="string"?a:void 0,De=ce(i),Pe=ce(r),de=De||d||$||Pe,He=Y||oe?{tabIndex:0,role:"region","aria-label":de,"aria-labelledby":i?re:le}:{},O={};U&&u&&(O.role="alert"),U&&!u&&(O.role="alertdialog",O["aria-describedby"]=ie),p.useEffect(()=>()=>{pe(document.body,`${n}--body--with-modal-open`,!1)},[n]),p.useEffect(()=>{pe(document.body,`${n}--body--with-modal-open`,m??!1)},[m,n]),p.useEffect(()=>{!m&&D&&setTimeout(()=>{D?.current?.focus()})},[m,D]),p.useEffect(()=>{const a=E=>{const v=E||N.current,M=v?v.querySelector(T?`.${n}--btn--secondary`:X):null;return M||R&&R.current};m&&(E=>{const v=a(E);v!==null&&v.focus()})(N.current)},[m,X,T,n]),et(()=>{C.current&&se(C.current.scrollHeight>C.current.clientHeight);function a(){C.current&&se(C.current.scrollHeight>C.current.clientHeight)}const g=rt(a,200);return window.addEventListener("resize",g),()=>{g.cancel(),window.removeEventListener("resize",g)}},[]);let S=t.isValidElement(I??f)?I??f:null;S&&S.type?.displayName==="AILabel"&&(S=t.cloneElement(S,{size:"sm"}));const ue=t.createElement("div",{className:`${n}--modal-close-button`},t.createElement(tt,{className:H,label:Z,onClick:h,"aria-label":Z,align:"left",ref:R},t.createElement(Xe,{size:20,"aria-hidden":"true",tabIndex:"-1",className:`${H}__icon`}))),ze=t.createElement("div",B({ref:N,role:"dialog"},O,{className:Oe,"aria-label":de,"aria-modal":"true",tabIndex:-1}),t.createElement("div",{className:`${n}--modal-header`},u&&ue,i&&t.createElement(me,{as:"h2",id:re,className:`${n}--modal-header__label`},i),t.createElement(me,{as:"h2",id:le,className:`${n}--modal-header__heading`},r),I?S:f?t.createElement("div",{className:`${n}--modal--inner__decorator`},S):"",!u&&ue),t.createElement(ge,B({ref:C,id:ie,className:Me},He),c),!u&&t.createElement(K,{className:Ae,"aria-busy":z},Array.isArray(_)&&_.length<=2?_.map((a,g)=>{let{buttonText:E,onClick:v}=a;return t.createElement(q,{key:`${E}-${g}`,kind:"secondary",onClick:v},E)}):x&&t.createElement(q,{disabled:z,kind:"secondary",onClick:Re,ref:te},x),t.createElement(q,{className:_e,kind:T?"danger":"primary",disabled:z||$e,onClick:G,ref:R},w==="inactive"?L:t.createElement(Ee,{status:w,description:xe,iconDescription:Le,className:`${n}--inline-loading--btn`,onSuccess:Se}))));return t.createElement(ge,B({},ee,{level:0,onKeyDown:Te,onClick:nt([ee?.onClick,we]),onBlur:F?()=>{}:Ie,className:Fe,role:"presentation",ref:s}),!F&&t.createElement("span",{ref:ne,tabIndex:0,role:"link",className:`${n}--visually-hidden`},"Focus sentinel"),ze,!F&&t.createElement("span",{ref:ae,tabIndex:0,role:"link",className:`${n}--visually-hidden`},"Focus sentinel"))});ve.propTypes={alert:e.bool,"aria-label":Je("hasScrollingContent",e.string),children:e.node,className:e.string,closeButtonLabel:e.string,danger:e.bool,decorator:e.node,hasScrollingContent:e.bool,id:e.string,isFullWidth:e.bool,launcherButtonRef:e.oneOfType([e.func,e.shape({current:e.any})]),loadingDescription:e.string,loadingIconDescription:e.string,loadingStatus:e.oneOf(["inactive","active","finished","error"]),modalAriaLabel:e.string,modalHeading:e.node,modalLabel:e.node,onKeyDown:e.func,onLoadingSuccess:e.func,onRequestClose:e.func,onRequestSubmit:e.func,onSecondarySubmit:e.func,open:e.bool,passiveModal:e.bool,preventCloseOnClickOutside:e.bool,primaryButtonDisabled:e.bool,primaryButtonText:e.node,secondaryButtonText:e.node,secondaryButtons:(l,o,s)=>{if(l.secondaryButtons){if(!Array.isArray(l.secondaryButtons)||l.secondaryButtons.length!==2)return new Error(`${o} needs to be an array of two button config objects`);const d={buttonText:e.node,onClick:e.func};l[o].forEach(c=>{e.checkPropTypes(d,c,o,s)})}return null},selectorPrimaryFocus:e.string,selectorsFloatingMenus:e.arrayOf(e.string.isRequired),shouldSubmitOnEnter:e.bool,size:e.oneOf(ct),slug:be(e.node)};const dt=l=>{const o=We();return je.jsx(ve,{closeButtonLabel:o.formatMessage({id:"dashboard.modal.close",defaultMessage:"Close"}),...l})};dt.__docgenInfo={description:"",methods:[],displayName:"Modal"};export{dt as M};
