import{a as u}from"./chunk-D5ZWXAHU-BihnyLEY.js";import{j as t}from"./jsx-runtime-B0wN4eWF.js";import{R as b,r as x}from"./index-BLsgEXh-.js";import{i as M}from"./index-CbuwW4_d.js";import{u as C}from"./usePrefix-DVhi0s40.js";import{B as h}from"./Button-DXQXyzWq.js";import{_ as V,F as k}from"./index-Cn2DnnuS.js";import{_ as f}from"./index-CvulwabO.js";import{c as A}from"./index-7UTgOZSF.js";import{L as v}from"./Link-DsPvONv9.js";import{S as y}from"./Search-C-UQoaUd.js";import{T as j}from"./Tag-CDRgvZ2L.js";import{A as N}from"./Notification-D7G8vrn6.js";import"./v4-CtRu48qb.js";import"./index-DS1rTf2F.js";import"./index-mhCn_TNf.js";import"./Tooltip-wylFaEsh.js";import"./index-DN2bqo_D.js";import"./keys-fZP-1wUt.js";import"./events-OVwOsPzJ.js";import"./index-CTl86HqP.js";import"./index-yR6ZHKQV.js";import"./FormContext-D3yeToZb.js";import"./bucket-3-igrvqujs.js";import"./Icon-Dlg6_ItC.js";import"./bucket-14-DcJR6G3p.js";import"./Text-9nRGETFr.js";import"./noopFn-g4z370MD.js";import"./wrapFocus-Cvvm2ck9.js";import"./bucket-9-CFGufIsT.js";import"./bucket-18-D1v83Eua.js";import"./bucket-6-KyTwAsSL.js";function F(r){let{className:l,children:e,...i}=r;const n=C(),a=A(`${n}--form`,l);return b.createElement("form",V({className:a},i),e)}F.propTypes={children:f.node,className:f.string};function g(r){return t.jsx(k,{enableExperimentalFocusWrapWithoutSentinels:!0,children:t.jsx(N,{...r})})}g.__docgenInfo={description:"",methods:[],displayName:"ActionableNotification"};function _(r){return r.filter((l,e)=>r.indexOf(l)>=e)}class c extends x.Component{state={currentFilterValue:"",isValid:!0,filterMessage:null,url:"",urlMessage:""};handleAddFilter=l=>{l.preventDefault();const{intl:e}=this.props,{currentFilterValue:i}=this.state,n="([a-z0-9A-Z-_./]:[a-z0-9A-Z-_.],?)+",a=i.replace(/\s/g,"");if(!a.match(n)){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.invalid",defaultMessage:"Filters must be of the format labelKey:labelValue and contain accepted label characters"}),url:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set",urlMessage:e.formatMessage({id:"dashboard.labelFilter.syntaxMessage",defaultMessage:"See the Kubernetes Label documentation for valid syntax"})});return}if(a.split(":")[1].length>63){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.invalidLength",defaultMessage:"Filters must be of the format labelKey:labelValue and contain less than 64 characters"})});return}let s=a.replace(/:/g,"=").split(",");if(s=_(s),this.props.filters.includes(s[0])){this.setState({isValid:!1,filterMessage:e.formatMessage({id:"dashboard.labelFilter.duplicate",defaultMessage:"No duplicate filters allowed"}),url:"",urlMessage:""});return}this.props.handleAddFilter(this.props.filters.concat(s)),this.resetCurrentFilterValue()};handleChange=l=>{const e=l.target.value;this.setState({currentFilterValue:e})};handleCloseFilterError=()=>{this.setState({isValid:!0,filterMessage:null,url:"",urlMessage:""})};resetCurrentFilterValue(){this.setState({isValid:!0,filterMessage:null,url:"",urlMessage:"",currentFilterValue:""})}render(){const{filters:l,intl:e}=this.props,{currentFilterValue:i,filterMessage:n,isValid:a,url:p,urlMessage:m}=this.state,s=e.formatMessage({id:"dashboard.labelFilter.searchPlaceholder",defaultMessage:"Input a label filter of the format labelKey:labelValue"});return t.jsxs("div",{className:"tkn--label-filter",children:[!a&&t.jsx(g,{inline:!0,kind:"error",lowContrast:!0,title:n,onCloseButtonClick:this.handleCloseFilterError,children:t.jsx(v,{href:p,children:m})}),t.jsxs(F,{onSubmit:this.handleAddFilter,autoComplete:"on",children:[t.jsx(y,{placeholder:s,labelText:s,onChange:this.handleChange,value:i,name:"filter-search",size:"lg"}),t.jsx(h,{type:"submit",className:"tkn--visually-hidden",children:e.formatMessage({id:"dashboard.labelFilter.addFilterButton",defaultMessage:"Add filter"})})]}),t.jsxs("div",{className:"tkn--filters",children:[l.map(o=>t.jsx(j,{filter:!0,onClick:()=>this.props.handleDeleteFilter(o),onClose:()=>this.props.handleDeleteFilter(o),type:"high-contrast",children:o.replace(/=/g,":")},o)),l.length>0&&t.jsx(h,{kind:"ghost",size:"sm",onClick:this.props.handleClearFilters,children:e.formatMessage({id:"dashboard.labelFilter.clearAll",defaultMessage:"Clear all"})})]})]})}}c.defaultProps={filters:[]};const S=M(c);c.__docgenInfo={description:"",methods:[{name:"handleAddFilter",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"handleCloseFilterError",docblock:null,modifiers:[],params:[],returns:null},{name:"resetCurrentFilterValue",docblock:null,modifiers:[],params:[],returns:null}],displayName:"LabelFilter",props:{filters:{defaultValue:{value:"[]",computed:!1},required:!1}}};const de={component:S,title:"LabelFilter"},d={args:{filters:["tekton.dev/pipeline=output-pipeline"],handleAddFilter:u("handleAddFilter"),handleClearFilters:u("handleClearFilters"),handleDeleteFilter:u("handleDeleteFilter")}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    filters: ['tekton.dev/pipeline=output-pipeline'],
    handleAddFilter: action('handleAddFilter'),
    handleClearFilters: action('handleClearFilters'),
    handleDeleteFilter: action('handleDeleteFilter')
  }
}`,...d.parameters?.docs?.source}}};const ue=["Default"];export{d as Default,ue as __namedExportsOrder,de as default};
