import{j as e}from"./jsx-runtime-B0wN4eWF.js";import{R as f,r as z}from"./index-BLsgEXh-.js";import{_ as t}from"./index-CvulwabO.js";import{u as B}from"./index-CbuwW4_d.js";import{j as Y,t as G}from"./index-CfoIBI3E.js";import{P as J,u as Q}from"./usePrefix-DVhi0s40.js";import{d as U}from"./index-CLdR1d0e.js";import{m as C,_ as O,d as X}from"./index-Cn2DnnuS.js";import{c as q}from"./index-7UTgOZSF.js";import{L as Z}from"./index-BIJfH8ZR.js";import{c as ee}from"./events-OVwOsPzJ.js";import{n as $}from"./noopFn-g4z370MD.js";import{a as se,A as te,c as ne}from"./keys-fZP-1wUt.js";import{g as ae}from"./wrapFocus-Cvvm2ck9.js";import{b as S,d as T,T as re,a as oe,c as ie}from"./Tabs-4y_hjRYw.js";import{T as le}from"./Tooltip-wylFaEsh.js";import{V as P}from"./ViewYAML-BQtIWtmr.js";import{T as L}from"./Table-C546lFM3.js";import{D as ce}from"./DetailsHeader-B1o2hUA4.js";import{d as de}from"./constants-CJ-WDauL.js";import{c as ue}from"./bucket-9-CFGufIsT.js";let A=class extends f.Component{constructor(){super(...arguments),C(this,"_switchRefs",[]),C(this,"state",{selectedIndex:void 0}),C(this,"handleItemRef",s=>a=>{this._switchRefs[s]=a}),C(this,"handleChildChange",s=>{const{selectionMode:a="automatic"}=this.props,{selectedIndex:o}=this.state,{index:n}=s,{key:y}=s;if(se(s,[te,ne])){const r=ae(y,n,this.props.children?.length),i=f.Children.toArray(this.props.children);if(a==="manual"){const d=this._switchRefs[r];d&&d.focus()}else this.setState({selectedIndex:r},()=>{if(typeof this.state.selectedIndex!="number")return;const d=i[this.state.selectedIndex],x=this._switchRefs[this.state.selectedIndex];x&&x.focus(),this.props.onChange({...s,index:this.state.selectedIndex,name:d.props.name,text:d.props.text})})}else o!==n&&this.setState({selectedIndex:n},()=>{const r=this._switchRefs[n];r&&r.focus(),this.props.onChange(s)})})}static getDerivedStateFromProps(s,a){let{selectedIndex:o=0}=s;const{prevSelectedIndex:n}=a;return n===o?null:{selectedIndex:o,prevSelectedIndex:o}}render(){const s=this.context,{children:a,className:o,light:n,selectedIndex:y=0,selectionMode:r="automatic",size:i,onChange:d=$,...x}=this.props,j=f.Children?.map(a,u=>u.type.displayName==="IconSwitch")?.every(u=>u===!0),m=q(`${s}--content-switcher`,o,{[`${s}--content-switcher--light`]:n,[`${s}--content-switcher--${i}`]:i,[`${s}--layout--size-${i}`]:i,[`${s}--content-switcher--icon-only`]:j});return f.createElement(Z,O({size:{default:"md",min:"sm",max:"lg"}},x,{className:m,role:"tablist",onChange:void 0}),a&&f.Children.toArray(a).map((u,h)=>f.cloneElement(u,{index:h,onClick:ee([this.handleChildChange,u.props.onClick]),onKeyDown:this.handleChildChange,selected:h===this.state.selectedIndex,ref:this.handleItemRef(h),size:i})))}};C(A,"propTypes",{children:t.node,className:t.string,light:X(t.bool),onChange:t.func.isRequired,selectedIndex:t.number,selectionMode:t.oneOf(["automatic","manual"]),size:t.oneOf(["sm","md","lg"])});C(A,"contextType",J);const he=U(A),_=f.forwardRef(function(s,a){const{children:o,className:n,disabled:y,index:r,name:i,onClick:d=$,onKeyDown:x=$,selected:j=!1,text:m,...u}=s,h=Q(),k=g=>{g.preventDefault(),d?.({index:r,name:i,text:m})},R=g=>{const M=g.key||g.which;x?.({index:r,name:i,text:m,key:M})},v=q(n,`${h}--content-switcher-btn`,{[`${h}--content-switcher--selected`]:j}),N={onClick:k,onKeyDown:R,className:v,disabled:y};return f.createElement("button",O({type:"button",ref:a,role:"tab",tabIndex:j?0:-1,"aria-selected":j},u,N),f.createElement("span",{className:`${h}--content-switcher__label`,title:m},m!==void 0?m:o))});_.displayName="Switch";_.propTypes={children:t.node,className:t.string,disabled:t.bool,index:t.number,name:t.oneOfType([t.string,t.number]),onClick:t.func,onKeyDown:t.func,selected:t.bool,text:t.string};function V({children:c}){return c?e.jsx(P,{className:"tkn--param",resource:c}):null}V.__docgenInfo={description:"",methods:[],displayName:"Param"};function F({title:c}){return c?e.jsx(le,{align:"top-end",autoAlign:!0,label:c,children:e.jsx("button",{className:"tkn--tooltip-trigger",type:"button",children:e.jsx(ue,{})})}):null}function K(c){return c?c.reduce((s,{name:a,description:o})=>(s[a]=o,s),{}):{}}const E={onViewChange:()=>{},task:{},taskRun:{}},W=({onViewChange:c=E.onViewChange,pod:s,skippedTask:a,task:o=E.task,taskRun:n=E.taskRun,view:y})=>{const r=B(),i=n.metadata.name,d=o?.spec||n.spec.taskSpec,x=K(d?.params),j=K(d?.results),[m,u]=z.useState(),h=s?.events?.length>0,k=typeof s?.resource=="string"?s.resource:{...s?.resource};k?.metadata?.managedFields&&delete k.metadata.managedFields;let R;h&&(R=s.events.map(l=>{const b={...l};return delete b.metadata?.managedFields,b})),z.useEffect(()=>{u("resource")},[i,y]);const v=[{key:"name",header:r.formatMessage({id:"dashboard.taskRunParams.name",defaultMessage:"Name"})},{key:"value",header:r.formatMessage({id:"dashboard.taskRunParams.value",defaultMessage:"Value"})},{key:"actions",header:""}],N=Y(n.spec),g=N?.length?e.jsx(L,{size:"sm",headers:v,rows:N.map(({name:l,value:b})=>({id:l,name:l,actions:e.jsx(F,{title:x[l]}),value:e.jsx("span",{title:b,children:e.jsx(V,{children:b})})}))}):null,M=n.status?.taskResults||n.status?.results,D=M?.length?e.jsx(L,{size:"sm",headers:v,rows:M.map(({name:l,value:b})=>({id:l,name:l,actions:e.jsx(F,{title:j[l]}),value:e.jsx("span",{title:b,children:e.jsx(V,{children:b})})}))}):null,H=[g&&"params",D&&"results","status",!a&&s&&"pod"].filter(Boolean);let w=H.indexOf(y);w===-1&&(w=0);const I=[],p=[];return g&&(I.push(e.jsx(S,{children:r.formatMessage({id:"dashboard.taskRun.params",defaultMessage:"Parameters"})},"params")),p.push(e.jsx(T,{children:w===p.length&&e.jsx("div",{className:"tkn--step-status",children:g})},"params"))),D&&(I.push(e.jsx(S,{children:r.formatMessage({id:"dashboard.taskRun.results",defaultMessage:"Results"})},"results")),p.push(e.jsx(T,{children:w===p.length&&e.jsx("div",{className:"tkn--step-status",children:D})},"results"))),I.push(e.jsx(S,{children:r.formatMessage({id:"dashboard.taskRun.status",defaultMessage:"Status"})},"status")),p.push(e.jsx(T,{children:w===p.length&&e.jsx("div",{className:"tkn--step-status",children:e.jsx(P,{dark:!0,enableSyntaxHighlighting:!0,resource:a||n.status||r.formatMessage({id:"dashboard.taskRun.status.pending",defaultMessage:"Pending"})})})},"status")),!a&&s&&(I.push(e.jsx(S,{children:"Pod"},"pod")),p.push(e.jsx(T,{children:w===p.length&&e.jsxs("div",{className:"tkn--step-status",children:[h?e.jsxs(he,{onChange:({name:l})=>u(l),children:[e.jsx(_,{name:"resource",text:r.formatMessage({id:"dashboard.pod.resource",defaultMessage:"Resource"})}),e.jsx(_,{name:"events",text:r.formatMessage({id:"dashboard.pod.events",defaultMessage:"Events"})})]}):null,m==="resource"?e.jsx(P,{dark:!0,enableSyntaxHighlighting:!0,resource:k}):null,h&&m==="events"?e.jsx(P,{dark:!0,enableSyntaxHighlighting:!0,resource:R}):null]})},"pod"))),e.jsxs("div",{className:"tkn--step-details",children:[e.jsx(ce,{displayName:i,hasWarning:G(n),reason:a?de:null,taskRun:n,type:"taskRun"}),e.jsxs(re,{onChange:l=>c(H[l.selectedIndex]),selectedIndex:w,children:[e.jsx(oe,{activation:"manual","aria-label":"TaskRun details",children:I}),e.jsx(ie,{children:p})]})]})};W.propTypes={onViewChange:t.func,task:t.shape({}),taskRun:t.shape({})};W.__docgenInfo={description:"",methods:[],displayName:"TaskRunDetails",props:{onViewChange:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},task:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1},taskRun:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"shape",value:{}},required:!1}}};export{W as T};
